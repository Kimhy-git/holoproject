<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.mapper">

	<!-- test -->
	<select id="selectMember" resultType="dto">
        select * from user;
    </select>
    
    <!-- help_me 게시글 리스트 -->
	<select id="list" resultType="dto_p">
		select * from help_post where board=1 order by help_post_id desc;
	</select>
	
	<!-- help_me likes -->
	<select id="likes" resultType="dto_p">
		select user.nick, user.likes from help_post, user where user.user_id = help_post.user_user_id;
	</select>
	
	<!-- help_me 게시글 상세보기 -->
	<select id="read" resultType="dto_p">
		select * from help_post where help_post_id = #{help_post_id}
	</select>
	
	<!-- help_me 게시글 쓰기 -->
	<select id="write" parameterType="dto_p">
		insert into help_post (tag_area, board, title, nick, tag_job, content, gender, min_price, payment, complete, user_user_id) 
		values(#{tag_area},1,#{title},"hi",#{tag_job},#{content},#{gender},#{min_price},#{payment},0,"1")
	</select>
	<!-- help_me 게시글 수정 -->
	
	<!-- help_me 게시글 삭제 -->
	<select id="delete" resultType="dto_p">
		delete from help_post where help_post_id=#{help_post_id} 
	</select>
	<!-- help_me댓글 보기 -->
	<select id="re_list" resultType="dto_pr">
	 	select * from help_reply where help_post_post_id=#{help_post_id}
	</select>
	<!-- help_me댓글 작성 -->
	<select id="re_write"  resultType="dto_pr" parameterType="dto_pr">
		insert into help_reply (board,re_index, re_comment, re_class, re_order, groupNum, help_post_post_id, 
		user_user_id) values(1,1,#{re_comment},1,1,1,#{help_post_post_id},'abc123') ;
	</select>
	<!-- help_me댓글 수정 -->
	<select id="re_edit" resultType="dto_pr">
		update help_reply setre_comment=#{re_comment} where help_reply_id=#{help_reply_id}; 
	</select>		
	<!-- help_me댓글 삭제 -->
	<select id="re_delete" resultType="dto_pr">
		delete from help_reply where help_reply_id=#{help_reply_id} 
	</select>
	<!-- help_me 수정 댓글 보기 -->
	<select id="re_edit_view" resultType="dto_pr">
		select * from help_reply where help_reply_id=#{help_reply_id}
	</select>
	
	
	
	<!-- help_you -->
	<select id="helpyou_list" resultType="dto_p">
		select * from help_post where board=0
	</select>
	<!-- helpyou_write -->
	<insert id="helpyou_submit" parameterType="dto_p">
		insert into help_post(tag_area, board, title, nick, tag_job, content, img, gender, min_price, payment, complete, user_user_id)
		 values(#{tag_area},0,#{title},(select nick from user where user_id='a'),#{tag_job},#{content},#{img},#{gender},#{min_price},#{payment},0,'a');
	</insert>
	<!-- helpyou_write_view -->
	<select id="helpyou_write_view" parameterType="int" resultType="dto_p">
		select * from help_post where help_post_id=#{help_post_id}
	</select>
	<!-- helpyou write delete -->
	<delete id="helpyou_delete" parameterType="int">
		delete from help_post where help_post_id=#{help_post_id}
	</delete>
	<!-- helpyou_reply_done -->
	<insert id="helpyou_reply_submit">
		insert into help_reply(board, re_index, re_comment, re_class, re_order, groupNum, help_post_post_id, user_user_id)
		 values(0, 0, #{re_comment}, 0, 0, 1, #{help_post_post_id}, #{user_user_id})
	</insert>
	<!-- helpyou_reply_list -->
	<select id="helpyou_reply_list" parameterType="int" resultType="dto_pr">
		select * from help_reply where board=0 and help_post_post_id=#{help_post_post_id}
	</select>
	<delete id="helpyou_reply_delete" parameterType="int">
		delete from help_reply where help_reply_id=#{help_post_post_id}
	</delete>



	<!-- notice -->

    <select id="select_post" resultType="dto_post"> 
    	select * from post where board=0; 
    </select>
    
     <!-- notice_write : add posts -->
    <select id="add_post" parameterType="Dto_post"> 
    	insert into post(board, title, nick, content, img, user_user_id)
		values(0,#{title},'One',#{content},#{img},'a');
    </select>
    
    <!-- notice_write_view : add comments -->
    <select id="add_comment" parameterType="dto_reply"> 
    	insert into reply(board,re_index,re_comment,post_post_id,user_user_id)
		values(0,0,#{re_comment},#{post_post_id},'a');	
    </select>
    
    <!-- notice_write_view -->
    <select id="select_post_view" resultType="dto_post_view"> 
    	select * from post where board=0 and post_id=#{post_id}; 
    </select>
    
    <!-- notice_write_view : comment -->
    <select id="select_post_reply" resultType="dto_post_reply"> 
    	select * from reply where board=0 and post_post_id=#{post_id}
    	order by re_index, reply_id; 
    </select>
    
    <!-- notice_write_view : delete posts -->
    <select id="select_post_delete" resultType="dto_post_delete"> 
    	delete from post where post_id=#{post_id} and board=0;
    </select>
    
    <!-- notice_write_view : delete comments with a post -->
    <select id="select_reply_delete" resultType="dto_reply_delete"> 
    	delete from reply where post_post_id=#{post_post_id} and board=0;
    </select>
    
     <!-- notice_write_view : delete comments ONLY -->
    <select id="delete_comment" resultType="delete_comment"> 
    	delete from reply where reply_id=#{reply_id} and board=#{board} and
    	post_post_id=#{post_post_id};
    </select>
    
    <!-- update comments -->
    <select id="update_comment" resultType="update_comment"> 
    	update reply set re_comment=#{re_comment}
    	where board=0 and reply_id=#{reply_id} and post_post_id=#{post_post_id};
    </select>
    
    <!-- update posts -->
    <select id="update_post_title" resultType="update_post"> 
    	update post set title=#{title}
    	where board=#{board} and post_id=#{post_id};
    </select>
    
    <!-- update posts -->
    <select id="update_post_content" resultType="update_post"> 
    	update post set content=#{content}
    	where board=#{board} and post_id=#{post_id};
    </select>
    
    <!-- notice_write_view : add re_comments -->
    <select id="add_re_comment" parameterType="dto_reply"> 
    	insert into reply(board,re_index,re_comment,re_order,groupNum,post_post_id,user_user_id)
		values(0,#{re_index},#{re_comment},#{re_order},#{groupNum},#{post_post_id},'a');	
    </select>
    
    
    
    
    
    
    
    
    
    
    
    <!-- freeboard -->
    <select id="select_freeboard" resultType="dto_freeboard">
        select * from post where board=1;
    </select>
    <!-- 리스트 보기 -->
    
    <select id="select_freeboard_view" resultType="dto_freeboard">
        select * from post where board=1 and post_id=#{post_id};
    </select>
    <!-- 게시글 보기 -->
    
    <select id="select_freeboard_delete" resultType="dto_freeboard"> 
    	delete from post where post_id=#{post_id} and board=1;
    </select>
    <!-- 게시글 삭제 -->
    
    <select id="select_freeboard_reply_delete" resultType="dto_freeboard"> 
    	delete from reply where post_post_id=#{post_id} and board=1;
    </select>
    <!-- 댓글 삭제 -->
    
    
    <select id="freeboard_write" parameterType="dto_freeboard">
    	insert into post(post_id, board, title, content,user_user_id) 
    		values (10,1,#{title},#{content},"b");
    </select>


</mapper>